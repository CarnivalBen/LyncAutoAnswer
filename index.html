<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>LyncAutoAnswer by shanselman</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>LyncAutoAnswer</h1>
        <h2>Lync 2012 Super Simple Auto Answer Video Kiosk with Full Screen</h2>
		<h2>UI Suppressed & Non-UI Suppressed editions</h2>
        <a href="https://github.com/shanselman/LyncAutoAnswer" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>About LyncAutoAnswer</h1>

<p>I have a machine at my remote office in Seattle that is dedicated to Lync Video. For whatever reason the Lync folks don't include basic checkbox options like "Auto Answer" and "Start Video Automatically when someone calls" and "Make Video Fullscreen". So, I did all that myself using the Lync SDK. Which is a nightmare. But it's done, so that's something.</p>

<ul>
	<li>Kiosk application with auto-answer</li>
	<li>Auto-start video call</li>
	<li>Full-screen video</li>
	<li>Ideal for remote workers</li>
</ul>	

<p>I have <a href="http://www.hanselman.com/blog/CategoryView.aspx?category=Remote+Work">dozens of articles on my blog dedicated to Remote Work setup</a> that I hope you check out. I <a href="http://www.hanselman.com/blog/IntroducingLyncAutoAnswercomAnOpenSourceRemoteWorkersAutoAnswerKioskWithLync2010.aspx">wrote about this LyncAutoAnswer project as well.</a></p>

<p>Feel free to have fun with the code, but we only guarantee that it "Works on My Machine.&copy;&trade;"
<br/><img src="https://a248.e.akamai.net/camo.github.com/96621e3d29b54618ff80e5adb021019d58751a36/687474703a2f2f7777772e68616e73656c6d616e2e636f6d2f626c6f672f636f6e74656e742f62696e6172792f57696e646f77734c6976655772697465722f496e74726f647563696e67526f636b5363726f6c6c5f433239432f776f726b732d6f6e2d6d792d6d616368696e652d7374617262757273745f332e706e67"</>
</p>

<p>If you like it, <a href="http://hanselman.com/fightdiabetes">give money to Diabetes Research</a>.</p>

<h1>Quick Setup Instructions</h1>
<p>If you just want something that works and don't want to build it yourself, grab one of the binaries on the right. They're the Release builds of each of the different editions, built for AnyCPU. The readme in each file has specific instructions.</p>	

<p>The general idea is simple. You create a Lync account that is NOT you; it's an account for your cart and the one you will call. Mine is called "Cart #7." I made a Domain Account that does NOT have the ability to login to a desktop. It doesn't have file system or network share access, it can only use Lync. Then I setup my remote machine to auto logon when it boots up. I also disabled it's power management and screensaver as this is a dumb kiosk. </p>

            
<p>Then you change the Lync Auto Answer settings like this:</p>
<pre>
&lt;userSettings&gt;
      &lt;SuperSimpleLyncKiosk.Properties.Settings&gt;
        &lt;setting name="sipEmailAddress" serializeAs="String"&gt;               
            &lt;value&gt;sip:scottha@you.com&lt;/value&gt; &lt;!-- THIS IS YOU --&gt;  
      &lt;/setting&gt;    
    &lt;setting name="LyncAccountDomainUser" serializeAs="String"&gt; 
         &lt;value&gt;DOMAIN\thecart7&lt;/value&gt;   
     &lt;/setting&gt;    
    &lt;setting name="LyncAccountEmail" serializeAs="String"&gt;
          &lt;value&gt;thecart7@you.com&lt;/value&gt;  
      &lt;/setting&gt;   
     &lt;setting name="LyncAccountPassword" serializeAs="String"&gt;   
       &lt;value&gt;&lt;![CDATA[YOUR*CART*PASSWORDISHERE]]&gt;
    &lt;/value&gt;   
     &lt;/setting&gt;  
    &lt;/SuperSimpleLyncKiosk.Properties.Settings&gt;&lt;/userSettings&gt;
</pre>
   <p>And that's it! The kiosk does the rest.</p>
<h1>Which Edition?</h1>

<p>There's two editions of this project. The 'normal' way is to run code alongside the Lync Client - Non UI Suppressed. The other way is to run UI Suppressed. Both versions are below so you can see the differences: read about them and pick your favorite to play with.</p>

<h2>Not UI Suppressed Edition</h2>
<p>This got written and <a href="http://www.hanselman.com/blog/IntroducingLync2010SuperSimpleAutoAnswerVideoKioskWithFullScreen.aspx">blogged about</a> first. It doesn't require you to do anything special other than have Microsoft Lync 2010 running. It will auto-answer calls, connect video and go full screen.</p>

             <p><img src="images\image_thumb_5.png" /></p>

<p>A special nod to the <a href="http://inputsimulator.codeplex.com/">InputSimulator project on CodePlex</a>, as I'm using his excellent library.</p>

<p>To build or change this project, open the proj file in the <b>Not UI Suppressed</b> folder.</p>

<h2>UI Suppressed Edition</h2>
<p>
	After writing the Not UI Suppressed edition, I reached out to <a href="http://thoughtstuff.co.uk">Tom</a> for help with making a UI Suppressed	version so I could do true full-screen and have more control, as it's complicated to use Lync in UI Suppression Mode. The guys at <a href="http://www.modalitydev.net">Modality Systems</a> wrote me a wrapper class (<a href="https://github.com/tomorgan/Lync-UISuppression-VideoAutoAnswer">also a GitHub project</a>) which takes a lot of that pain away, and refactored my code to make a UI Suppressed edition.
</p>
           <p><img src="images\image_8.png" /></p>
             <p><img src="images\image_9.png" /></p>

<p>You can see, build or change the UI Suppressed version by opening the proj file in the <b>UI Suppressed</b> folder.

<h3>UI Suppression Mode</h3>
<p>UI Suppression Mode is a special setting in Lync which hides the client whilst still allowing the SDK to run and communicate with the underlying process. It's a more powerful method of using the SDK, but means you have to do all the work (such as signing in, getting presence etc.)</p>

<p>To use UI Suppression Mode you need to make a registry change to tell Lync you want to use it. Close Lync (not just sign out) and then run the right script for your environment:</p>

<ul>
	<li>32bit machines: <a href="https://github.com/downloads/shanselman/LyncAutoAnswer/32bit-UISuppression-ON.reg">Suppression ON</a> | <a href="https://github.com/downloads/shanselman/LyncAutoAnswer/32bit-UISuppression-OFF.reg">Suppression OFF</a></li>
	<li>64bit machines: <a href="https://github.com/downloads/shanselman/LyncAutoAnswer/64bit-UISuppression-ON.reg">Suppression ON</a> | <a href="https://github.com/downloads/shanselman/LyncAutoAnswer/64bit-UISuppression-OFF.reg">Suppression OFF</a></li>
</ul>

<p>You can also find these scripts in the <a href="https://github.com/shanselman/LyncAutoAnswer/downloads">Download</a> section</p>


            <p><img src="images\itworks.png" /></p>


<h1>More Information / Resources</h1>
	<ul>
	<li>Both projects use the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=18898">Lync 2010 Client Developer SDK</a></li>
	<li>The UI Suppression edition uses the <a href="https://github.com/tomorgan/Lync-UISuppression-VideoAutoAnswer">Lync-UISuppression-VideoAutoAnswer project</a>.</li>
	<li><a href="http://www.hanselman.com/blog/IntroducingLync2010SuperSimpleAutoAnswerVideoKioskWithFullScreen.aspx">Scott's blog post about writing the Not UI Suppressed edition</a> as well as this new <a href="http://www.hanselman.com/blog/IntroducingLyncAutoAnswercomAnOpenSourceRemoteWorkersAutoAnswerKioskWithLync2010.aspx"> UI Suppressed Edition</a>.</li>
	<li><a href="http://www.modalitydev.net/2012/08/open-source-project-lyncautoanswer/">Tom's blog post about writing the UI Suppressed edition</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/hh345230.aspx">MSDN article on UI Suppression</a></li>
	</ul>
	
	

        </section>

        <aside id="sidebar">
          <a href="https://github.com/downloads/shanselman/LyncAutoAnswer/SuperSimpleLyncKiosk_NotUISuppressed_Release.zip" class="button">
            <small>NOT UI SUPPRESSED EDITION</small>
            .zip Binaries
          </a>
          <a href="https://github.com/downloads/shanselman/LyncAutoAnswer/SuperSimpleLyncKiosk_UISuppressed_Release.zip" class="button">
            <small>UI SUPPRESSED EDITION</small>
            .zip Binaries
          </a>

		  <div class="team">Built by...</div>
		  
		  <div class="author">
			<img src="images/Scott.jpg" alt="Scott Hanselman, author of Hanselman.com"/>
			<p><a href="https://twitter.com/shanselman">Scott Hanselman</a> is a web technologist and teacher. He works out of his home office in Portland for the Web Platform Team at Microsoft, and blogs at <a href="http://www.hanselman.com">Scott Hanselman's Computer Zen</a>.</p>			
		  </div>
		  
		  <div class="author">
			<img src="images/Tom.jpg" alt="Tom Morgan, author of ThoughtStuff.co.uk"/>
			<p><a href="https://twitter.com/tomorgan">Tom Morgan</a> is a software engineer based in Norwich, Norfolk. He works for Modality Systems and blogs at <a href="http://thoughtstuff.co.uk">ThoughtStuff</a> and the <a href="http://modalitydev.net">ModalityDev</a> blog.</p>			
		  </div>
		  
		  <div class="author">
			<img src="images/Paul.jpg" alt="Paul Nearney, author of CodeLync.com"/>
			<p><a href="https://twitter.com/paulnearney">Paul Nearney</a> heads up the software development and consultancy team at Modality Systems.He blogs at <a href="http://www.codelync.com">CodeLync</a> and the <a href="http://modalitydev.net">ModalityDev</a> blog.</p>			
		  </div>
		  
		   <div class="author">
			<img src="images/Modality.jpg" alt="Modality Systems"/>
			<p><a href="http://modalitysystems.com/">Modality Systems</a> is a specialist provider of strategic and technical consulting services for communication and collaborations technologies and software development for Communications Enabled Business Processes (CEBP). The product development team blog at <a href="http://modalitydev.net">ModalityDev<a/> about writing great software.</p>			
		  </div>
		  
        </aside>
      </div>
    </div>

  
  </body>
</html>